# Enterprise Erigon Configuration for Maximum Performance
# Based on proven patterns from high-performance blockchain providers
# Target: Sub-200ms response times with optimal memory and CPU usage

# Data directory configuration
datadir = "/data/blockchain/storage/erigon"
chain = "mainnet"

# Database optimization for SSDs
[db]
pagesize = "16k"
path = "/data/blockchain/storage/erigon"

# Memory and cache optimization
[cache]
database = 8192
trie = 2048
gc = 1024
snapshot = 1024
preimages = 256

# Pruning configuration for performance
[prune]
mode = "full"
# Keep last 90000 blocks for better query performance
h = 90000
r = 90000
t = 90000
c = 90000
s = 90000

# Network and peer configuration
[p2p]
protocol = [68, 67]
port = 30309
nat = "any"
maxpeers = 25
nodiscovery = false
bootnode = []
staticnode = []

# HTTP RPC optimization
[http]
enabled = true
host = "0.0.0.0"
port = 8545
api = ["eth", "net", "web3", "txpool", "erigon", "debug", "trace", "engine"]
vhosts = ["*"]
corsdomain = ["*"]
rpcprefix = ""
gascap = 50000000
txfeecap = 1.0

# WebSocket configuration
[ws]
enabled = true
host = "0.0.0.0" 
port = 8546
api = ["eth", "net", "web3", "txpool", "erigon"]
origins = ["*"]

# Authentication RPC for consensus clients
[authrpc]
addr = "0.0.0.0"
port = 8551
vhosts = ["*"]
jwtsecret = "/data/blockchain/storage/erigon/jwt.hex"

# Private API for internal communication
[private_api]
addr = "0.0.0.0:9091"

# Transaction pool optimization
[txpool]
accountslots = 16
globalslots = 10000
accountqueue = 64
globalqueue = 5000
pricelimit = 1
pricebump = 10
locals = []
nolocals = false
journal = "transactions.rlp"
rejournal = "1h0m0s"
lifetime = "3h0m0s"

# Gas price oracle configuration
[gpo]
blocks = 20
percentile = 60
maxheaderage = 300
maxblockage = 10

# Metrics and monitoring
[metrics]
enabled = true
addr = "0.0.0.0"
port = 6062
path = "/debug/metrics"

# Logging configuration
[log]
console_verbosity = "info"
dir_path = "/var/log/erigon"
dir_verbosity = 3
json = false

# Torrent configuration for better sync performance
[torrent]
verbosity = 1
upload_rate = "512mb"
download_rate = "1024mb"
port = 42069
conns_per_file = 10
download_slots = 6

# Snapshots configuration
[snapshots]
enabled = true
verify = true

# Header downloader optimization
[headerdownloader]
verify = true
penalize_pow_blocks = false

# Bodies downloader configuration
[bodies]
cache = true

# State optimization
[state]
stream = true
cache = true