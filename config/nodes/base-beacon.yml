version: '3.8'

services:
  base-beacon:
    image: sigp/lighthouse:v5.3.0
    container_name: base-beacon
    restart: unless-stopped
    networks:
      - base-network
    ports:
      - "5054:5054"  # HTTP API
      - "5055:5055"  # Metrics
      - "9011:9001/tcp"  # P2P TCP
      - "9011:9001/udp"  # P2P UDP
    volumes:
      - /data/blockchain/storage/base-beacon:/root/.lighthouse
      - /data/blockchain/storage/base/geth/jwtsecret:/jwt.hex:ro
    command: |
      lighthouse bn
      --network base-mainnet
      --checkpoint-sync-url https://base-mainnet-consensus-api.cbhq.net
      --execution-endpoint http://base-node:8551
      --execution-jwt /jwt.hex
      --datadir /root/.lighthouse
      --http
      --http-address 0.0.0.0
      --metrics
      --metrics-address 0.0.0.0
      --port 9001
      --target-peers 100

networks:
  base-network:
    external: true
    name: base-network